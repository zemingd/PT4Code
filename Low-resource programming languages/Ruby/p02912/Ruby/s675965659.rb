eval"_,M,*A="+`dd`.split*?,;(1..2**30).bsearch{|i|d=M;k=0;A.map{|a|(a/=2;d-=1)until i>a;k+=a};X=k-i/2*d;-d};p X