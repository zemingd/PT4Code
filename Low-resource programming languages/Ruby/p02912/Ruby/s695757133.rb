eval"N,M,*A="+`dd`.split*?,;f=->i{d=k=0;A.map{|a|d-=b=(0..99).find{|j|a>>j<=i};k+=a>>b};X=k--~i/2*d+=M;d>=0};f[(0..10**9).bsearch &f];p X