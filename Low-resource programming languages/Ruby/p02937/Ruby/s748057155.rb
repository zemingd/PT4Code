S,T=*$<;a=0;N=S=~/$/
T.chop.chars{a<0||a+=(x=S.index _1)?1+(S[a%N..N].index(_1)||-a%N+x):~a}
p a